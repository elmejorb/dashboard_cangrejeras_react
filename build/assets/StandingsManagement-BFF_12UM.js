import{c as $,X as A,d,e as w,Y as b,Z as U,_ as O,$ as G,b as z,a0 as V,q as H,a1 as X,g as Y,r as C,j as e,B as S,T as q,a as T,L as N,I as j,t as m}from"./index-rVBsoLmu.js";import{D as Z,a as K,b as Q,c as W,d as k}from"./dialog-DyW0Rv7O.js";import{P as M}from"./plus-CsQDuX2Y.js";import{P as ee}from"./pen-Cn057YqI.js";import{T as te}from"./trash-2-DYaLxA-3.js";import{X as ae}from"./x-CfwQjJuw.js";import{S as se}from"./save-Bm5X-n4m.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M5 12h14",key:"1ays0h"}]],ie=$("minus",re);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M8 18L12 22L16 18",key:"cskvfv"}],["path",{d:"M12 2V22",key:"r89rzk"}]],oe=$("move-down",ne);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M8 6L12 2L16 6",key:"1yvkyx"}],["path",{d:"M12 2V22",key:"r89rzk"}]],ce=$("move-up",le);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]],xe=$("trending-down",de),g="standings",p={getAllStandings:async()=>{try{const t=z(d,g),a=H(t,X("position","asc"));return(await Y(a)).docs.map(r=>({id:r.id,name:r.data().name,abbr:r.data().abbr,points:r.data().points||0,played:r.data().played||0,won:r.data().won||0,lost:r.data().lost||0,color:r.data().color||"#0C2340",position:r.data().position||0,createdAt:r.data().createdAt?.toDate()||new Date,updatedAt:r.data().updatedAt?.toDate()||new Date}))}catch(t){throw console.error("Error fetching standings:",t),t}},getStandingsTeam:async t=>{try{const a=w(d,g,t),n=await V(a);if(!n.exists())return null;const r=n.data();return{id:n.id,name:r.name,abbr:r.abbr,points:r.points||0,played:r.played||0,won:r.won||0,lost:r.lost||0,color:r.color||"#0C2340",position:r.position||0,createdAt:r.createdAt?.toDate()||new Date,updatedAt:r.updatedAt?.toDate()||new Date}}catch(a){throw console.error("Error getting standings team:",a),a}},createStandingsTeam:async t=>{try{const a=await p.getAllStandings(),n=a.length>0?Math.max(...a.map(o=>o.position)):0,r={name:t.name.trim(),abbr:t.abbr.trim().toUpperCase(),points:t.points||0,played:t.played||0,won:t.won||0,lost:t.lost||0,color:t.color||"#0C2340",position:n+1,createdAt:b(),updatedAt:b()};return{id:(await G(z(d,g),r)).id,name:r.name,abbr:r.abbr,points:r.points,played:r.played,won:r.won,lost:r.lost,color:r.color,position:r.position,createdAt:new Date,updatedAt:new Date}}catch(a){throw console.error("Error creating standings team:",a),a}},updateStandingsTeam:async(t,a)=>{try{const n=w(d,g,t),r={};Object.keys(a).forEach(o=>{const x=a[o];x!==void 0&&(r[o]=x)});const l={...r,updatedAt:b()};await O(n,l)}catch(n){throw console.error("Error updating standings team:",n),n}},deleteStandingsTeam:async t=>{try{const a=await p.getStandingsTeam(t);if(!a)throw new Error("Equipo no encontrado");const n=w(d,g,t);await U(n);const r=await p.getAllStandings(),l=A(d);r.filter(o=>o.position>a.position).forEach(o=>{const x=w(d,g,o.id);l.update(x,{position:o.position-1,updatedAt:b()})}),await l.commit()}catch(a){throw console.error("Error deleting standings team:",a),a}},reorderStandings:async t=>{try{const a=A(d);t.forEach((n,r)=>{const l=w(d,g,n.id);a.update(l,{position:r+1,updatedAt:b()})}),await a.commit()}catch(a){throw console.error("Error reordering standings:",a),a}},moveTeamUp:async t=>{try{const a=await p.getAllStandings(),n=a.findIndex(y=>y.id===t);if(n<=0)return;const r=A(d),l=a[n],o=a[n-1],x=w(d,g,l.id),u=w(d,g,o.id);r.update(x,{position:o.position,updatedAt:b()}),r.update(u,{position:l.position,updatedAt:b()}),await r.commit()}catch(a){throw console.error("Error moving team up:",a),a}},moveTeamDown:async t=>{try{const a=await p.getAllStandings(),n=a.findIndex(y=>y.id===t);if(n<0||n>=a.length-1)return;const r=A(d),l=a[n],o=a[n+1],x=w(d,g,l.id),u=w(d,g,o.id);r.update(x,{position:o.position,updatedAt:b()}),r.update(u,{position:l.position,updatedAt:b()}),await r.commit()}catch(a){throw console.error("Error moving team down:",a),a}},initializeDefaultStandings:async()=>{try{if((await p.getAllStandings()).length>0)return;const a=[{name:"Cangrejeras de Santurce",abbr:"CAN",points:48,played:21,won:16,lost:5,color:"#0C2340"},{name:"Criollas de Caguas",abbr:"CRI",points:45,played:21,won:15,lost:6,color:"#E01E37"},{name:"Gigantes de Carolina",abbr:"GIG",points:42,played:20,won:14,lost:6,color:"#10B981"},{name:"Pinkin de Corozal",abbr:"PIN",points:36,played:21,won:12,lost:9,color:"#EC4899"},{name:"Valkirias de Toa Baja",abbr:"VAL",points:24,played:20,won:8,lost:12,color:"#8B5CF6"},{name:"Changas de Naranjito",abbr:"CHA",points:15,played:21,won:5,lost:16,color:"#F97316"}];for(let n=0;n<a.length;n++)await p.createStandingsTeam(a[n]);console.log("Default standings initialized")}catch(t){throw console.error("Error initializing default standings:",t),t}}};function ye({darkMode:t}){const[a,n]=C.useState([]),[r,l]=C.useState(!0),[o,x]=C.useState(!1),[u,y]=C.useState(null),[i,h]=C.useState({}),E=async()=>{l(!0);try{await p.initializeDefaultStandings();const s=await p.getAllStandings();n(s)}catch(s){console.error("Error loading standings:",s),m.error("Error al cargar tabla de posiciones")}finally{l(!1)}};C.useEffect(()=>{E()},[]);const B=s=>s===0?"up":s===a.length-1?"down":"same",P=s=>{y(s),h(s),x(!0)},I=()=>{y(null),h({name:"",abbr:"",points:0,played:0,won:0,lost:0,color:"#0C2340"}),x(!0)},L=async()=>{if(!i.name||!i.abbr){m.error("Por favor completa todos los campos requeridos");return}try{u?(await p.updateStandingsTeam(u.id,{name:i.name,abbr:i.abbr,points:i.points||0,played:i.played||0,won:i.won||0,lost:i.lost||0,color:i.color||"#0C2340"}),m.success("Equipo actualizado exitosamente")):(await p.createStandingsTeam({name:i.name,abbr:i.abbr,points:i.points||0,played:i.played||0,won:i.won||0,lost:i.lost||0,color:i.color||"#0C2340"}),m.success("Equipo agregado exitosamente")),await E(),x(!1),y(null),h({})}catch(s){m.error("Error al guardar equipo"),console.error(s)}},R=async s=>{if(confirm("¿Estás seguro de eliminar este equipo?"))try{await p.deleteStandingsTeam(s),await E(),m.success("Equipo eliminado exitosamente")}catch(c){m.error("Error al eliminar equipo"),console.error(c)}},F=async(s,c)=>{if(c!==0)try{await p.moveTeamUp(s),await E(),m.success("Posición actualizada")}catch(v){m.error("Error al actualizar posición"),console.error(v)}},_=async(s,c)=>{if(c!==a.length-1)try{await p.moveTeamDown(s),await E(),m.success("Posición actualizada")}catch(v){m.error("Error al actualizar posición"),console.error(v)}};if(r)return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#C8A963]"})})});const f=a.find(s=>s.name.includes("Cangrejeras")),J=f?(f.won/f.played*100).toFixed(1):"0",D=a.length>=2?a[0].points-a[1].points:0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:"Tabla de Posiciones"}),e.jsx("p",{className:`text-sm mt-1 ${t?"text-white/60":"text-gray-600"}`,children:"Administra las posiciones de la liga"})]}),e.jsxs(S,{onClick:I,className:"bg-[#C8A963] hover:bg-[#b89850] text-white",children:[e.jsx(M,{size:16,className:"mr-2"}),"Agregar Equipo"]})]}),e.jsx("div",{className:`rounded-xl border overflow-hidden ${t?"bg-[#1E293B]/50 border-white/10 backdrop-blur-xl":"bg-white/80 border-gray-200 backdrop-blur-xl"}`,children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:t?"bg-white/5":"bg-gray-50",children:[e.jsx("th",{className:`px-6 py-4 text-left text-xs font-medium uppercase tracking-wider ${t?"text-white/70":"text-gray-500"}`,children:"Pos"}),e.jsx("th",{className:`px-6 py-4 text-left text-xs font-medium uppercase tracking-wider ${t?"text-white/70":"text-gray-500"}`,children:"Equipo"}),e.jsx("th",{className:`px-6 py-4 text-center text-xs font-medium uppercase tracking-wider ${t?"text-white/70":"text-gray-500"}`,children:"Pts"}),e.jsx("th",{className:`px-6 py-4 text-center text-xs font-medium uppercase tracking-wider ${t?"text-white/70":"text-gray-500"}`,children:"JJ"}),e.jsx("th",{className:`px-6 py-4 text-center text-xs font-medium uppercase tracking-wider ${t?"text-white/70":"text-gray-500"}`,children:"JG"}),e.jsx("th",{className:`px-6 py-4 text-center text-xs font-medium uppercase tracking-wider ${t?"text-white/70":"text-gray-500"}`,children:"JP"}),e.jsx("th",{className:`px-6 py-4 text-right text-xs font-medium uppercase tracking-wider ${t?"text-white/70":"text-gray-500"}`,children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-white/10",children:a.map((s,c)=>{const v=B(c);return e.jsxs("tr",{className:`transition-colors ${t?"hover:bg-white/5":"hover:bg-gray-50"} ${c===0?t?"bg-[#C8A963]/10":"bg-[#C8A963]/5":""}`,children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-bold ${t?"text-white":"text-gray-900"}`,children:c+1}),v==="up"&&e.jsx(q,{size:14,className:"text-[#10B981]"}),v==="down"&&e.jsx(xe,{size:14,className:"text-[#E01E37]"}),v==="same"&&e.jsx(ie,{size:14,className:t?"text-white/40":"text-gray-400"}),c===0&&e.jsx(T,{size:14,className:"text-[#C8A963]"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-white font-bold text-sm",style:{backgroundColor:s.color},children:s.abbr}),e.jsx("div",{className:`font-medium ${t?"text-white":"text-gray-900"}`,children:s.name})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx("span",{className:`px-3 py-1 rounded-full font-bold ${t?"bg-[#C8A963]/20 text-[#C8A963]":"bg-[#C8A963]/10 text-[#C8A963]"}`,children:s.points})}),e.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-center ${t?"text-white/80":"text-gray-700"}`,children:s.played}),e.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-center ${t?"text-white/80":"text-gray-700"}`,children:s.won}),e.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-center ${t?"text-white/80":"text-gray-700"}`,children:s.lost}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>F(s.id,c),disabled:c===0,className:`p-1.5 rounded-lg transition-colors ${c===0?"opacity-30 cursor-not-allowed":t?"hover:bg-white/10 text-white/70":"hover:bg-gray-100 text-gray-600"}`,title:"Subir posición",children:e.jsx(ce,{size:16})}),e.jsx("button",{onClick:()=>_(s.id,c),disabled:c===a.length-1,className:`p-1.5 rounded-lg transition-colors ${c===a.length-1?"opacity-30 cursor-not-allowed":t?"hover:bg-white/10 text-white/70":"hover:bg-gray-100 text-gray-600"}`,title:"Bajar posición",children:e.jsx(oe,{size:16})}),e.jsx("button",{onClick:()=>P(s),className:`p-1.5 rounded-lg transition-colors ${t?"hover:bg-[#C8A963]/20 text-[#C8A963]":"hover:bg-[#C8A963]/10 text-[#C8A963]"}`,title:"Editar equipo",children:e.jsx(ee,{size:16})}),e.jsx("button",{onClick:()=>R(s.id),className:`p-1.5 rounded-lg transition-colors ${t?"hover:bg-[#E01E37]/20 text-[#E01E37]":"hover:bg-[#E01E37]/10 text-[#E01E37]"}`,title:"Eliminar equipo",children:e.jsx(te,{size:16})})]})})]},s.id)})})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:`rounded-xl border p-6 ${t?"bg-[#1E293B]/50 border-white/10 backdrop-blur-xl":"bg-white/80 border-gray-200 backdrop-blur-xl"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-[#C8A963]/10",children:e.jsx(T,{size:20,className:"text-[#C8A963]"})}),e.jsxs("div",{children:[e.jsxs("div",{className:`text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:[a.findIndex(s=>s.name.includes("Cangrejeras"))+1,"°"]}),e.jsx("div",{className:`text-sm ${t?"text-white/60":"text-gray-600"}`,children:"Posición Actual"})]})]}),e.jsx("div",{className:`text-xs mt-3 pt-3 border-t ${t?"border-white/10 text-white/50":"border-gray-200 text-gray-500"}`,children:a[0]?.name.includes("Cangrejeras")?"Cangrejeras lideran la tabla":`${a.findIndex(s=>s.name.includes("Cangrejeras"))>0?D+" pts del líder":"Sin datos"}`})]}),e.jsxs("div",{className:`rounded-xl border p-6 ${t?"bg-[#1E293B]/50 border-white/10 backdrop-blur-xl":"bg-white/80 border-gray-200 backdrop-blur-xl"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-[#10B981]/10",children:e.jsx(q,{size:20,className:"text-[#10B981]"})}),e.jsxs("div",{children:[e.jsxs("div",{className:`text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:[J,"%"]}),e.jsx("div",{className:`text-sm ${t?"text-white/60":"text-gray-600"}`,children:"Efectividad"})]})]}),e.jsx("div",{className:`text-xs mt-3 pt-3 border-t ${t?"border-white/10 text-white/50":"border-gray-200 text-gray-500"}`,children:f?`${f.won} victorias en ${f.played} partidos`:"Sin datos"})]}),e.jsxs("div",{className:`rounded-xl border p-6 ${t?"bg-[#1E293B]/50 border-white/10 backdrop-blur-xl":"bg-white/80 border-gray-200 backdrop-blur-xl"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-[#0C2340]/10",children:e.jsx(T,{size:20,style:{color:"#0C2340"}})}),e.jsxs("div",{children:[e.jsxs("div",{className:`text-2xl font-bold ${t?"text-white":"text-gray-900"}`,children:["+",a.length>=2?D:0]}),e.jsx("div",{className:`text-sm ${t?"text-white/60":"text-gray-600"}`,children:"Diferencia de Puntos"})]})]}),e.jsx("div",{className:`text-xs mt-3 pt-3 border-t ${t?"border-white/10 text-white/50":"border-gray-200 text-gray-500"}`,children:a[0]?.name.includes("Cangrejeras")?"Ventaja sobre el 2° lugar":a.length>=2?"Diferencia con el líder":"Sin datos"})]})]}),e.jsx(Z,{open:o,onOpenChange:x,children:e.jsxs(K,{className:`sm:max-w-[500px] ${t?"bg-[#0F172A] border-white/20":"bg-white"}`,children:[e.jsxs(Q,{children:[e.jsx(W,{className:t?"text-white":"text-gray-900",children:u?"Editar Equipo":"Agregar Equipo"}),e.jsx(k,{className:t?"text-white/60":"text-gray-600",children:u?"Actualiza la información del equipo":"Agrega un nuevo equipo a la tabla de posiciones"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"name",className:t?"text-white":"text-gray-900",children:"Nombre del Equipo *"}),e.jsx(j,{id:"name",value:i.name||"",onChange:s=>h({...i,name:s.target.value}),placeholder:"Ej: Cangrejeras de Santurce",className:t?"bg-[#1E293B] border-white/20 text-white placeholder:text-white/40":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"abbr",className:t?"text-white":"text-gray-900",children:"Abreviatura (máx. 3 letras) *"}),e.jsx(j,{id:"abbr",value:i.abbr||"",onChange:s=>h({...i,abbr:s.target.value.toUpperCase().slice(0,3)}),placeholder:"Ej: CAN",maxLength:3,className:t?"bg-[#1E293B] border-white/20 text-white placeholder:text-white/40":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"color",className:t?"text-white":"text-gray-900",children:"Color del Equipo"}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx(j,{id:"color",type:"color",value:i.color||"#0C2340",onChange:s=>h({...i,color:s.target.value}),className:"w-20 h-10 cursor-pointer"}),e.jsx(j,{value:i.color||"#0C2340",onChange:s=>h({...i,color:s.target.value}),placeholder:"#0C2340",className:`flex-1 ${t?"bg-[#1E293B] border-white/20 text-white placeholder:text-white/40":""}`}),e.jsx("div",{className:"w-10 h-10 rounded-lg border-2 border-white/20",style:{backgroundColor:i.color||"#0C2340"}})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"points",className:t?"text-white":"text-gray-900",children:"Puntos"}),e.jsx(j,{id:"points",type:"number",min:"0",value:i.points||0,onChange:s=>h({...i,points:parseInt(s.target.value)||0}),className:t?"bg-[#1E293B] border-white/20 text-white":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"played",className:t?"text-white":"text-gray-900",children:"Juegos Jugados"}),e.jsx(j,{id:"played",type:"number",min:"0",value:i.played||0,onChange:s=>h({...i,played:parseInt(s.target.value)||0}),className:t?"bg-[#1E293B] border-white/20 text-white":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"won",className:t?"text-white":"text-gray-900",children:"Juegos Ganados"}),e.jsx(j,{id:"won",type:"number",min:"0",value:i.won||0,onChange:s=>h({...i,won:parseInt(s.target.value)||0}),className:t?"bg-[#1E293B] border-white/20 text-white":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"lost",className:t?"text-white":"text-gray-900",children:"Juegos Perdidos"}),e.jsx(j,{id:"lost",type:"number",min:"0",value:i.lost||0,onChange:s=>h({...i,lost:parseInt(s.target.value)||0}),className:t?"bg-[#1E293B] border-white/20 text-white":""})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsxs(S,{variant:"outline",onClick:()=>{x(!1),y(null),h({})},className:t?"border-white/10 text-white hover:bg-white/5":"",children:[e.jsx(ae,{size:16,className:"mr-2"}),"Cancelar"]}),e.jsxs(S,{onClick:L,className:"bg-[#C8A963] hover:bg-[#b89850] text-white",children:[e.jsx(se,{size:16,className:"mr-2"}),u?"Actualizar":"Agregar"]})]})]})})]})}export{ye as StandingsManagement};
